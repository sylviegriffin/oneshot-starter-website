---
interface Props {
  title: string;
  description?: string;
  image?: string;
}

const {
  title,
  description = "Executive burnout recovery coaching for high-performers who can't afford to slow down.",
  image = "/og.png"
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site || 'http://localhost:4321');
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- SEO -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />
    <meta name="generator" content={Astro.generator} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={new URL(image, Astro.site || 'http://localhost:4321')} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />

    <!-- Theme -->
    <meta name="theme-color" content="#FAF8F5" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#1A1815" media="(prefers-color-scheme: dark)" />

    <!-- Fonts preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  </head>
  <body>
    <!-- Subtle paper texture overlay -->
    <div class="texture-overlay" aria-hidden="true"></div>

    <slot />

    <!-- Global scroll reveal script -->
    <script>
      // Scroll reveal observer
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -60px 0px'
      });

      document.querySelectorAll('[data-reveal]').forEach(el => observer.observe(el));

      // Dark mode toggle (respects system preference)
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');

      function updateTheme(e: MediaQueryListEvent | MediaQueryList) {
        if (e.matches) {
          document.documentElement.setAttribute('data-theme', 'dark');
        } else {
          document.documentElement.removeAttribute('data-theme');
        }
      }

      updateTheme(prefersDark);
      prefersDark.addEventListener('change', updateTheme);
    </script>
  </body>
</html>

<style is:global>
  @import '../styles/tokens.css';
  @import '../styles/reset.css';
  @import '../styles/global.css';
</style>

<style>
  /* Subtle paper texture for warmth */
  .texture-overlay {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: var(--z-max);
    opacity: 0.015;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-repeat: repeat;
    mix-blend-mode: multiply;
  }

  [data-theme="dark"] .texture-overlay {
    opacity: 0.03;
    mix-blend-mode: soft-light;
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .texture-overlay {
      display: none;
    }
  }
</style>
